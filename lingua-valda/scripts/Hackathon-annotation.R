###

# Author: Antoine Silvestre de Sacy
# Title: Scripts d'analyse linguistique pour le Hackathon de l'ADEMEC
# Date: 25/09/2021
# Tags: hackathon, ADEMEC, ENC, TAL, NLP, stylistique.

### 

# Importation des librairies : 

library("udpipe")
library("tidyverse")
library("vroom")
library("stringr")
library("dplyr")
library("udpipe")

## Répertoire de travail : 

setwd("~/txt/")

## Importation et lecture des données :

# Fichiers txt :

list_of_files <- list.files(recursive = TRUE,
                            pattern = "*.txt", 
                            full.names = TRUE)

df <- vroom(list_of_files, id = "FileName", delim = "\n", col_names = "mots", progress = T)

# Échantillonnage : 

# df <- df[1:10000,]

df = df %>%
  na.omit(df$mots)

## Nettoyage : retrait identifier, creator, date, title : 

df$mots <- str_replace_all(df$mots, pattern = "title: .*", replacement = "")
df$mots <- str_replace_all(df$mots, pattern = "identifier: .*", replacement = "")
df$mots <- str_replace_all(df$mots, pattern = "creator: .*", replacement = "")
df$mots <- str_replace_all(df$mots, pattern = "date: .*", replacement = "")

# Nettoyage : ajout d'un saut de ligne en bout pour éviter erreurs étiquetage :
# Nettoyage encodage apostrophes :

df <- df %>%
  mutate(mots = stringr::str_replace_all(.$mots, "$", "\n")) %>%
  mutate(mots = stringr::str_replace_all(.$mots, "=", "")) %>%
  mutate(mots = stringr::str_replace_all(.$mots, "’", "'")) %>%
  mutate(mots = stringr::str_replace_all(.$mots, "'", "'"))

# Téléchargement du modèle d'annotation : 

# TODO : Télécharger une seule fois le modèle avec la commande suivante :
# TODO : dl <- udpipe_download_model(language = "french")

model = "~/Motifs/model_udpipe/french-gsd-ud-2.5-191206.udpipe"
udmodel_french <- udpipe_load_model(file = model)

# Annotation :

corpus_annote <- udpipe_annotate(udmodel_french, x = df$mots, tagger = "default", parser = "none", trace = TRUE, doc_id = df$FileName)

# Transformation en df : 
corpus_annote <- as.data.frame(corpus_annote)

# Correction de l'identifiant : retrait "./" au début :
corpus_annote$doc_id <- gsub("\\.\\/", "", corpus_annote$doc_id)

# Sélection des colonnes qui nous intéressent : 
corpus_annote_cols <- corpus_annote[,c("token", "lemma", "upos", "feats", "doc_id")]
colnames(corpus_annote_cols) <- c("mots", "lemmes", "POS", "feats", "Oeuvre")

head(corpus_annote_cols)

# Exportation csv : 
# write.csv(corpus_annote_cols, "UDPipe_corpus_complet.csv", fileEncoding = "UTF-8")

# Détermination de la longueur de chaque position de thèse :

  # Calcul de la longueur des identifiants : 

count_id <- corpus_annote_cols %>%
  count(Oeuvre, sort = TRUE)

# Nettoyage par date : 

t <- str_extract_all(string = count_id$Oeuvre, pattern = "\\d{4}")

count_id$date <- t

# Ordonnancement ensuite par longueur des textes et par date : 

ggplot(data=count_id, aes(x=Oeuvre, y=n)) +
  geom_point(stat="identity", fill="steelblue")+
  # geom_text(aes(label=n), vjust=1.6, color="white", size=3.5)+
  theme_minimal() + 
  xlab("Évolution de la longueur des positions de thèses (nb de mots)") +
  theme(axis.text.x = element_blank())

# Récupération des mots les plus fréquents sur l'ensemble du corpus : 

  # Passage en minuscules :

corpus_lower <- tolower(corpus_annote_cols$mots)

corpus_lower_count <- corpus_annote_cols

corpus_lower_count$mots <- corpus_lower

# Count : 

count_mots <- corpus_lower_count %>%
  dplyr::count(mots, sort = TRUE)

  # Introduction des stopwords : 

# Retrait des stopwords à partir du fichier stopwords.txt : 

stopwords_list = scan("../stopwords.txt", what = "character") # 230 items

# Implémentation des stopwords :

count_mots <- count_mots %>%
  filter(!mots %in% stopwords_list)

#Turn your 'treatment' column into a character vector
count_mots$mots <- as.character(count_mots$mots)
#Then turn it back into a factor with the levels in the correct order
count_mots$mots <- factor(count_mots$mots, levels=unique(count_mots$mots))


# Visualisation :

ggplot(data=count_mots[1:20,], aes(x=mots, y=n)) +
  geom_bar(stat="identity", fill="steelblue")+
  # geom_text(aes(label=n), vjust=1.6, color="white", size=3.5)+
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1)) +
  xlab("Les chartistes et leurs mots")


## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 

## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 
## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 

## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 

# Patterns stylistiques les plus représentatifs du corpus : 

  # Passage du scripts de regex et transformation en motifs : 
  # Cf. Thx to me !! Cf. github.com/malichot/motifs

require("readr")
require("data.table")

## Importation du corpus : 

corpus = corpus_lower_count

## Vérification que les colonnes sont les bonnes : 

corpus <- corpus[,c('mots', 'lemmes', 'POS', 'feats', 'Oeuvre')] 

# Auxiliaires : 

corpus <- corpus %>%
  mutate(POS = replace(POS, lemmes == "être", "être")) %>% # Auxiliaires
  mutate(POS = replace(POS, lemmes == "avoir", "avoir")) # Auxiliaires

# Remplacement des feats avoir et être pour qu'ils ne soient pas transformés :
# (on garde les auxiliaires)

corpus <- corpus %>%
  mutate(feats = replace(feats, lemmes == "avoir", "avoir")) %>%
  mutate(feats = replace(feats, lemmes == "être", "être"))

# Infinitifs :

corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, feats == "Typo=Yes|VerbForm=Inf", "INF")) %>%
  mutate(lemmes = replace(lemmes, feats == "VerbForm=Inf", "INF")) %>%
  mutate(lemmes = replace(lemmes, feats == "Typo=No|VerbForm=Inf", "INF"))

# Participes : 

corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, feats == "Gender=Masc|Number=Sing|Tense=Past|Typo=Yes|VerbForm=Part", "PPAS")) %>% # PPsé masc sing
  mutate(lemmes = replace(lemmes, feats == "Gender=Masc|Number=Sing|Tense=Past|VerbForm=Part", "PPAS")) %>% # PPsé masc sing
  mutate(lemmes = replace(lemmes, feats == "Gender=Fem|Number=Sing|Tense=Past|Typo=Yes|VerbForm=Part", "PPAS")) %>% # PPsé fem sin
  mutate(lemmes = replace(lemmes, feats == "Gender=Fem|Number=Sing|Tense=Past|VerbForm=Part", "PPAS")) %>% # PPsé fem sin
  mutate(lemmes = replace(lemmes, feats == "Gender=Masc|Number=Plur|Tense=Past|Typo=Yes|VerbForm=Part", "PPAS")) %>% ## PPsé mas plu
  mutate(lemmes = replace(lemmes, feats == "Gender=Masc|Number=Plur|Tense=Past|VerbForm=Part", "PPAS")) %>% ## PPsé mas plu
  mutate(lemmes = replace(lemmes, feats == "Gender=Fem|Number=Plur|Tense=Past|VerbForm=Part", "PPAS")) %>% # PPsé fem plu
  mutate(lemmes = replace(lemmes, feats == "Gender=Fem|Number=Sing|Tense=Past|VerbForm=Part", "PPAS")) %>% # PPsé fem sing
  mutate(lemmes = replace(lemmes, feats == "Gender=Masc|Number=Plur|Tense=Past|VerbForm=Part", "PPAS")) %>% # PPsé masc plu
  mutate(lemmes = replace(lemmes, feats == "Tense=Pres|VerbForm=Part", "PPRES")) # Pprésnt.


############ Remplacement des verbes : ##

# Subjonctif présent :

corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Sing|Person=1|Tense=Pres|VerbForm=Fin", "VSUBP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Sing|Person=2|Tense=Pres|VerbForm=Fin", "VSUBP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Sing|Person=3|Tense=Pres|VerbForm=Fin", "VSUBP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Plur|Person=1|Tense=Pres|VerbForm=Fin", "VSUBP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Plur|Person=2|Tense=Pres|VerbForm=Fin", "VSUBP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Plur|Person=3|Tense=Pres|VerbForm=Fin", "VSUBP"))

# Subjonctif imparfait :

corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Sing|Person=1|Tense=Imp|VerbForm=Fin", "VSUBI")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Sing|Person=2|Tense=Imp|VerbForm=Fin", "VSUBI")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Sing|Person=3|Tense=Imp|VerbForm=Fin", "VSUBI")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Plur|Person=1|Tense=Imp|VerbForm=Fin", "VSUBI")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Plur|Person=2|Tense=Imp|VerbForm=Fin", "VSUBI")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Sub|Number=Plur|Person=3|Tense=Imp|VerbForm=Fin", "VSUBI"))

# Impératif présent :

corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Imp|Number=Sing|Person=2|Tense=Pres|VerbForm=Fin", "IMP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Imp|Number=Plur|Person=1|Tense=Pres|VerbForm=Fin", "IMP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Imp|Number=Plur|Person=2|Tense=Pres|VerbForm=Fin", "IMP"))

# Conditionnel :

corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Cnd|Number=Sing|Person=1|Tense=Pres|VerbForm=Fin", "VCOND")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Cnd|Number=Sing|Person=2|Tense=Pres|VerbForm=Fin", "VCOND")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Cnd|Number=Sing|Person=3|Tense=Pres|VerbForm=Fin", "VCOND")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Cnd|Number=Plur|Person=1|Tense=Pres|VerbForm=Fin", "VCOND")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Cnd|Number=Plur|Person=2|Tense=Pres|VerbForm=Fin", "VCOND")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Cnd|Number=Plur|Person=3|Tense=Pres|VerbForm=Fin", "VCOND"))

# Indicatif présent :

corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=1|Tense=Pres|VerbForm=Fin", "PRES")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=2|Tense=Pres|VerbForm=Fin", "PRES")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=3|Tense=Pres|VerbForm=Fin", "PRES")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=1|Tense=Pres|VerbForm=Fin", "PRES")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=2|Tense=Pres|VerbForm=Fin", "PRES")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=3|Tense=Pres|VerbForm=Fin", "PRES"))

# Imparfait :

corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=1|Tense=Imp|VerbForm=Fin", "VIMP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=2|Tense=Imp|VerbForm=Fin", "VIMP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=3|Tense=Imp|VerbForm=Fin", "VIMP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=1|Tense=Imp|VerbForm=Fin", "VIMP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=2|Tense=Imp|VerbForm=Fin", "VIMP")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=3|Tense=Imp|VerbForm=Fin", "VIMP"))

# Passé simple : 

corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=1|Tense=Past|VerbForm=Fin", "VPS")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=2|Tense=Past|VerbForm=Fin", "VPS")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=3|Tense=Past|VerbForm=Fin", "VPS")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=1|Tense=Past|VerbForm=Fin", "VPS")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=2|Tense=Past|VerbForm=Fin", "VPS")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=3|Tense=Past|VerbForm=Fin", "VPS"))

# Futur :

corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=1|Tense=Fut|VerbForm=Fin", "VF")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=2|Tense=Fut|VerbForm=Fin", "VF")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Sing|Person=3|Tense=Fut|VerbForm=Fin", "VF")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=1|Tense=Fut|VerbForm=Fin", "VF")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=2|Tense=Fut|VerbForm=Fin", "VF")) %>%
  mutate(lemmes = replace(lemmes, feats == "Mood=Ind|Number=Plur|Person=3|Tense=Fut|VerbForm=Fin", "VF"))

# Démonstratifs :

corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, feats == "Gender=Masc|Number=Sing|Poss=Yes|PronType=Prs", "DEPOSS")) %>%
  mutate(lemmes = replace(lemmes, feats == "Gender=Masc|Number=Sing|Poss=Yes|PronType=Prs", "DETPOSS")) %>%
  mutate(lemmes = replace(lemmes, feats == "Gender=Fem|Number=Sing|Poss=Yes|PronType=Prs", "DETPOSS")) %>%
  mutate(lemmes = replace(lemmes, feats == "Gender=Masc|Number=Plur|Poss=Yes|PronType=Prs", "DETPOSS")) %>%
  mutate(lemmes = replace(lemmes, feats == "Gender=Fem|Number=Plur|Poss=Yes|PronType=Prs", "DETPOSS"))


# Retrait colonne morphologie :

corpus <- corpus[,-4]

## Retrait des lignes vides :

corpus <- corpus[complete.cases(corpus),]

## ## ## ## ## ## ##  ## ## ## ## ## ##  ## ## ##  ## ## ## 

# REGEX #

## ## ## ## ## ## ##  ## ## ## ## ## ##  ## ## ##  ## ## ## 

# Transformation des lemmes en motifs :
# Il faut ici se fonder sur les lemmes puis transformer les POS pour qu'ils ne soient pas 
# changer ensuite au cours des transformations futures. Ex : on veut garder le verbe être
# pour qu'il demeure dans les motifs. Pour cela, obligationd de transformer le POS.

corpus <- corpus %>%
  #mutate(POS = replace(POS, lemmes == "être", "être")) %>% # Auxiliaires
  # mutate(POS = replace(POS, lemmes == "avoir", "avoir")) %>% # Auxiliaires
  mutate(POS = replace(POS, lemmes == "ne", "ne")) %>%
  mutate(POS = replace(POS, lemmes == "plusieurs", "plusieurs")) %>% # Noms communs
  mutate(POS = replace(POS, lemmes == "fois", "fois")) %>%
  mutate(POS = replace(POS, lemmes == "façon", "façon")) %>%
  mutate(POS = replace(POS, lemmes == "sorte", "sorte")) %>%
  mutate(POS = replace(POS, lemmes == "espèce", "espèce")) %>%
  mutate(POS = replace(POS, lemmes == "jour", "jour")) %>%
  mutate(POS = replace(POS, lemmes == "nuit", "nuit")) %>%
  mutate(POS = replace(POS, lemmes == "tel", "tel")) %>%
  mutate(POS = replace(POS, lemmes == "pas vrai", "pas vrai")) %>%
  mutate(POS = replace(POS, lemmes == "à peu près", "à peu près")) %>%
  mutate(POS = replace(POS, lemmes == "de le côté du", "de le côté de le")) %>%
  mutate(POS = replace(POS, lemmes == "être", "être")) %>%
  mutate(POS = replace(POS, lemmes == "tenir", "tenir")) %>%
  mutate(POS = replace(POS, lemmes == "prendre", "prendre")) %>%
  mutate(POS = replace(POS, lemmes == "pouvoir", "pouvoir")) %>%
  mutate(POS = replace(POS, lemmes == "passer", "passer")) %>%
  mutate(POS = replace(POS, lemmes == "parler", "parler")) %>%
  mutate(POS = replace(POS, lemmes == "laisser", "laisser")) %>%
  mutate(POS = replace(POS, lemmes == "donner", "donner")) %>%
  mutate(POS = replace(POS, lemmes == "penser", "penser")) %>%
  mutate(POS = replace(POS, lemmes == "arriver", "arriver")) %>%
  mutate(POS = replace(POS, lemmes == "mettre", "mettre")) %>%
  #mutate(POS = replace(POS, lemmes == "faire", "faire")) %>%
  #mutate(POS = replace(POS, lemmes == "aller", "aller")) %>%
  mutate(POS = replace(POS, lemmes == "falloir", "falloir")) %>%
  mutate(POS = replace(POS, lemmes == "finir", "finir")) %>%
  mutate(POS = replace(POS, lemmes == "commencer", "commencer")) %>%
  mutate(POS = replace(POS, lemmes == "venir", "venir")) %>%
  mutate(POS = replace(POS, lemmes == "devoir", "devoir")) %>%
  mutate(POS = replace(POS, lemmes == "paraître", "paraître")) %>%
  mutate(POS = replace(POS, lemmes == "sembler", "sembler")) %>%
  mutate(POS = replace(POS, lemmes == "rester", "rester")) %>%
  mutate(POS = replace(POS, lemmes == "devenir", "devenir")) %>%
  mutate(POS = replace(POS, lemmes == "meilleur", "meilleur")) %>% # adjectifs
  mutate(POS = replace(POS, lemmes == "vrai", "vrai")) %>%
  mutate(POS = replace(POS, lemmes == "véritable", "véritable")) %>%
  mutate(POS = replace(POS, lemmes == "autre", "autre")) %>%
  mutate(POS = replace(POS, lemmes == "même", "même")) %>%
  mutate(POS = replace(POS, lemmes == "au contraire", "au contraire")) %>%
  mutate(POS = replace(POS, lemmes == "est-ce que", "est-ce que")) %>%
  mutate(POS = replace(POS, lemmes == "mal", "mal")) %>%
  mutate(POS = replace(POS, lemmes == "plutôt", "plutôt")) %>%
  mutate(POS = replace(POS, lemmes == "à demi", "à demi")) %>%
  mutate(POS = replace(POS, lemmes == "à peu près", "à peu près")) %>%
  mutate(POS = replace(POS, lemmes == "ainsi", "ainsi")) %>% # ADV
  mutate(POS = replace(POS, lemmes == "alors", "alors")) %>%
  mutate(POS = replace(POS, lemmes == "aussi", "aussi")) %>%
  mutate(POS = replace(POS, lemmes == "autant", "autant")) %>%
  mutate(POS = replace(POS, lemmes == "aucunement", "aucunement")) %>%
  mutate(POS = replace(POS, lemmes == "autrement", "autrement")) %>%
  mutate(POS = replace(POS, lemmes == "avant", "avant")) %>%
  mutate(POS = replace(POS, lemmes == "beaucoup", "beaucoup")) %>%
  mutate(POS = replace(POS, lemmes == "bien plus", "bien plus")) %>%
  mutate(POS = replace(POS, lemmes == "bien moins", "bien moins")) %>%
  mutate(POS = replace(POS, lemmes == "bien", "bien")) %>%
  mutate(POS = replace(POS, lemmes == "cependant", "cependant")) %>%
  mutate(POS = replace(POS, lemmes == "combien", "combien")) %>%
  mutate(POS = replace(POS, lemmes == "comment", "comment")) %>%
  mutate(POS = replace(POS, lemmes == "davantage", "davantage")) %>%
  mutate(POS = replace(POS, lemmes == "déjà", "déjà")) %>%
  mutate(POS = replace(POS, lemmes == "depuis", "depuis")) %>%
  mutate(POS = replace(POS, lemmes == "de très près", "de très près")) %>%
  mutate(POS = replace(POS, lemmes == "dorénavant", "dorénavant")) %>%
  mutate(POS = replace(POS, lemmes == "encore", "encore")) %>%
  mutate(POS = replace(POS, lemmes == "en plus", "en plus")) %>%
  mutate(POS = replace(POS, lemmes == "ensemble", "ensemble")) %>%
  mutate(POS = replace(POS, lemmes == "environ", "environ")) %>%
  mutate(POS = replace(POS, lemmes == "delà", "delà")) %>%
  mutate(POS = replace(POS, lemmes == "tandis", "tandis")) %>%
  mutate(POS = replace(POS, lemmes == "fort", "fort")) %>%
  mutate(POS = replace(POS, lemmes == "grandement", "grandement")) %>%
  mutate(POS = replace(POS, lemmes == "guère", "guère")) %>%
  mutate(POS = replace(POS, lemmes == "longtemps", "longtemps")) %>%
  mutate(POS = replace(POS, lemmes == "sous", "sous")) %>%
  mutate(POS = replace(POS, lemmes == "lors", "lors")) %>%
  mutate(POS = replace(POS, lemmes == "parfois", "parfois")) %>%
  mutate(POS = replace(POS, lemmes == "ici", "ici")) %>%
  mutate(POS = replace(POS, lemmes == "travers", "travers")) %>%
  mutate(POS = replace(POS, lemmes == "où", "où")) %>%
  mutate(POS = replace(POS, lemmes == "là", "là")) %>%
  mutate(POS = replace(POS, lemmes == "puis", "puis")) %>%
  mutate(POS = replace(POS, lemmes == "au-dessus", "au-dessus")) %>%
  mutate(POS = replace(POS, lemmes == "jusque", "jusque")) %>%
  mutate(POS = replace(POS, lemmes == "au-dessous", "au-dessous")) %>%
  mutate(POS = replace(POS, lemmes == "an", "ans")) %>%
  mutate(POS = replace(POS, lemmes == "mais", "mais")) %>%
  mutate(POS = replace(POS, lemmes == "mieux", "mieux")) %>%
  mutate(POS = replace(POS, lemmes == "moins", "moins")) %>%
  mutate(POS = replace(POS, lemmes == "nullement", "nullement")) %>%
  mutate(POS = replace(POS, lemmes == "par conséquent", "par conséquent")) %>%
  mutate(POS = replace(POS, lemmes == "par hasard", "par hasard")) %>%
  mutate(POS = replace(POS, lemmes == "pas", "pas")) %>%
  mutate(POS = replace(POS, lemmes == "plus", "plus")) %>%
  # mutate(POS = replace(POS, lemmes == "point", "point")) %>% # ATTENTION : ici pb car si NC ne fonctionne pas...
  mutate(POS = replace(POS, lemmes == "presque", "presque")) %>%
  mutate(POS = replace(POS, lemmes == "prou", "prou")) %>%
  mutate(POS = replace(POS, lemmes == "pourquoi", "pourquoi")) %>%
  mutate(POS = replace(POS, lemmes == "quasi", "quasi")) %>%
  mutate(POS = replace(POS, lemmes == "quasiment", "quasiment")) %>%
  mutate(POS = replace(POS, lemmes == "quelque", "quelque")) %>%
  mutate(POS = replace(POS, lemmes == "soudain", "soudain")) %>%
  mutate(POS = replace(POS, lemmes == "tant de", "tant de")) %>%
  mutate(POS = replace(POS, lemmes == "tard", "tard")) %>%
  mutate(POS = replace(POS, lemmes == "tôt", "tôt")) %>%
  mutate(POS = replace(POS, lemmes == "bientôt", "bientôt")) %>%
  mutate(POS = replace(POS, lemmes == "aussitôt", "aussitôt")) %>%
  mutate(POS = replace(POS, lemmes == "non plus", "non plus")) %>%
  mutate(POS = replace(POS, lemmes == "tout", "tout")) %>%
  mutate(POS = replace(POS, lemmes == "tout à coup", "tout à coup")) %>%
  mutate(POS = replace(POS, lemmes == "très", "très")) %>%
  mutate(POS = replace(POS, lemmes == "trop", "trop")) %>%
  mutate(POS = replace(POS, lemmes == "après", "après")) %>% 
  mutate(POS = replace(POS, lemmes == "voire", "voire")) %>%
  mutate(POS = replace(POS, lemmes == "peu", "peu")) %>%
  mutate(POS = replace(POS, lemmes == "heureusement", "heureusement")) %>%
  mutate(POS = replace(POS, lemmes == "malheureusement", "malheureusement")) %>%
  mutate(POS = replace(POS, lemmes == "également", "également")) %>%
  mutate(POS = replace(POS, lemmes == "pourquoi", "pourquoi")) %>%
  mutate(POS = replace(POS, lemmes == "par trop", "par trop")) %>%
  mutate(POS = replace(POS, lemmes == "tous les jours", "tous les jours")) %>%
  mutate(POS = replace(POS, lemmes == "de loin", "de loin")) %>%
  mutate(POS = replace(POS, lemmes == "comme toujours", "comme toujours")) %>%
  mutate(POS = replace(POS, lemmes == "d'ailleurs", "d'ailleurs")) %>%
  mutate(POS = replace(POS, lemmes == "dans l'ensemble", "dans l'ensemble")) %>%
  mutate(POS = replace(POS, lemmes == "surtout", "surtout")) %>%
  mutate(POS = replace(POS, lemmes == "pourtant", "pourtant")) %>%
  mutate(POS = replace(POS, lemmes == "réellement", "réellement")) %>%
  mutate(POS = replace(POS, lemmes == "à la fin", "à la fin")) %>%
  mutate(POS = replace(POS, lemmes == "à peine", "à peine")) %>%
  mutate(POS = replace(POS, lemmes == "au début", "au début")) %>%
  mutate(POS = replace(POS, lemmes == "d'abord", "d'abord")) %>%
  mutate(POS = replace(POS, lemmes == "tout d'abord", "tout d'abord")) %>%
  mutate(POS = replace(POS, lemmes == "enfin", "enfin")) %>%
  mutate(POS = replace(POS, lemmes == "ensuite", "ensuite")) %>%
  mutate(POS = replace(POS, lemmes == "jamais", "jamais")) %>%
  mutate(POS = replace(POS, lemmes == "toujours", "toujours")) %>%
  mutate(POS = replace(POS, lemmes == "maintenant", "maintenant")) %>%
  mutate(POS = replace(POS, lemmes == "si", "si")) %>%
  mutate(POS = replace(POS, lemmes == "oui", "oui")) %>%
  mutate(POS = replace(POS, lemmes == "non", "non")) %>%
  mutate(POS = replace(POS, lemmes == "peut-être", "peut-être")) %>%
  mutate(POS = replace(POS, lemmes == "monsieur", "monsieur")) %>%
  mutate(POS = replace(POS, lemmes == "quel", "quel")) %>%
  mutate(POS = replace(POS, lemmes == "chose", "chose")) %>%
  mutate(POS = replace(POS, lemmes == "tant", "tant")) %>%
  mutate(POS = replace(POS, lemmes == "milieu", "milieu")) %>%
  mutate(POS = replace(POS, lemmes == "madame", "monsieur"))

# if lemmes == x
# replace pos by lemmes ce qui permet 
# de sauver ensuite le motifs de la transformation.

# Précisions / insertions POS :
# Remplacement conditionnels : si corpus$lemmes == c(), remplacement des POS et lemmes en ADVTOT, etc.

corpus[corpus$lemmes %in% c("absolument", "complètement", "entièrement", "incomplètement", "intégralement", "parfaitement", "partiellement", "
                              pleinement", "quasiment", "radicalement", "rigoureusement", "strictement", "totalement"), c("lemmes", "POS")] <- "ADVTOT"

# ADVPHA

corpus[corpus$lemmes %in% c("actuellement", "adultérieurement", "anciennement", "antécédement", "antérieurement", "antiquement", "
                              dernièrement", "diurnement", "fraîchement", "futurement", "imminementimminent", "incessamment", "initialement", "nouvellement", "
                              nuitamment", "originairement", "originellement", "postérieurement", "posthumément", "préalablement", "précédemment", "
                              précocement", "préliminairement", "prématurément", "présentement", "primitivement", "prochainement", "
                              récemment", "tardivement", "ultérieurement", "ultimement"), c("lemmes", "POS")] <- "ADVPHA"

# ADV de fréquence

corpus[corpus$lemmes %in% c("accidentellement", "annuellement", "bihebdomadairement", "bimensuellement", "bimestriellement", 
                            "biquotidiennement", "bisannuellementcasuellement", "chroniquement", "constamment", "continuellement", "épisodiquement", "
                              exceptionnellement", "fréquemment", "hebdomadairement", "irrégulièrement", "journellement", "mensuellement", "
                              occasionnellement", "périodiquement", "perpétuellement", "pluriannuellement", "quotidiennement", "rarement", "
                              rarissimement", "régulièrement", "saisonnièrement", "séculairement", "semestriellement", "sempiternellement", "
                              sporadiquement", "trimestriellement", "trisannuellement"), c("lemmes", "POS")] <- "ADVFRE"

# ADV d'intensité

corpus[corpus$lemmes %in% c("abominablement", "abondamment", "admirablement", "adorablement", "
                              affreusement", "amplement", "anormalement", "appréciablement", "ardemment", "
                              astronomiquement", "atrocement", "autrement", "bigrement", "bougrement", "
                              capitalement", "catastrophiquement", "célestement", "chichement", "chouettement
                              ", "colossalement", "considérablement", "onvenablement", "copieusement", "cruellement
                              ", "cuisamment", "dangereusement", "délicieusement", "démentiellement", "démesurément
                              ", "déplorablement", "dérisoirement", "désastreusement", "désespéramment", "désespérément
                              ", "désolamment", "détestablement", "diablement", "diaboliquement", "diamétralement", "
                              diantrement", "disproportionnément", "divinement", "doublement", "draconiennement
                              ", "drastiquement", "drôlement", "durement", "éclatamment", "effrayamment", "
                              effroyablement", "éhontément", "éminemment", "énormément", "épatamment", "éperdument", "
                              épouvantablement", "étonnamment", "exagérément", "excédentairement", "excellemment", "
                              exceptionnellement", "excessivement", "exécrablement", "exorbitamment", "exquisément", "
                              extraordinairement", "extrêmement", "fabuleusement", "faiblement", "fameusement", "
                              fantastiquement", "faramineusement", "farouchement", "férocement", "fichtrement", "
                              fichument", "follement", "formidablement", "fortement", "foutrement", "foutument", "
                              franchement", "furieusement", "génialement", "gigantesquement", "grandement", "grassement", "
                              gravement", "grièvement", "haïssablement", "hautement", "hideusement", "horriblement", "
                              idéalement", "immaculément", "immensément", "immodérément", "impayablement", "
                              impeccablement", "imperceptiblement", "implacablement", "impressivement", "
                              inadmissiblement", "inappréciablement", "incalculablement", "incommensurablement", "
                              incomparablement", "inconcevablement", "incorrigiblement", "incorruptiblement", "
                              incroyablement", "incurablement", "indécrottablement", "indéfectiblement", "
                              indémontablement", "indépassablement", "indéracinablement", "indescriptiblement", "
                              indestructiblement", "indiciblement", "indomptablement", "inébranlablement", "
                              ineffablement", "inégalablement", "inénarrablement", "inépuisablement", "inestimablement", "
                              inexpiablement", "inexprimablement", "inextinguiblement", "inextirpablement", "
                              inextricablement", "infernalement", "infiniment", "inguérissablement", "inimaginablement", "
                              inimitablement", "innombrablement", "inoubliablement", "inqualifiablement", "insatiablement", "
                              insignement", "insondablement", "insoupçonnablement", "insoutenablement", "instamment", "
                              insuffisamment", "insupportablement", "insurmontablement", "insurpassablement", "intarissablement", "
                              intenablement", "intensément", "intensivement", "intolérablement", "invinciblement", "inviolablement", "
                              invraisemblablement", "invulnérablement", "irréconciliablement", "irrécusablement", "irréductiblement", "
                              irréfragablement", "irréfutablement", "irrémédiablement", "irrémissiblement", "irréparablement", "
                              irrépressiblement", "irrésistiblement", "irrespirablement", "joliment", "lamentablement", "largement", "
                              légèrement", "littéralement", "magnifiquement", "maigrement", "maximalement", "médiocrement", "merveilleusement", "
                              minimement", "mirifiquement", "mirobolamment", "modérément", "modiquement", "monstrueusement", "
                              monumentalement", "mortellement", "moyennement", "multiplement", "nettement", "notablement", "
                              outrageusement", "outrancièrement", "particulièrement", "passablement", "passionnément", "
                              phénoménalement", "plantureusement", "plénièrement", "pléthoriquement", "positivement", "
                              prodigieusement", "profondément", "puissamment", "quadruplement", "quellement", "radieusement", "
                              raisonnablement", "redoutablement", "relativement", "remarquablement", "résolument", "ridiculement", "
                              rudement", "sacrément", "satisfaisamment", "scandaleusement", "sensationnellement", "sensiblement", "
                              sérieusement", "significativement", "singulièrement", "souverainement", "spécialement", "spectaculairement", "
                              splendidement", "sublimement", "substantiellement", "suffisamment", "superbement", "supérieurement", "
                              superlativement", "suprêmement", "surabondamment", "surhumainement", "surréellement", "tellement", "
                              terriblement", "triplement", "vachement", "vertigineusement", "viscéralement", "vivement"), c("lemmes", "POS")] <- "ADVINT"

# Adverbes d'habitude

corpus[corpus$lemmes %in% c("communément", "coutumièrement", "généralement", "habituellement", "invariablement", "
                              normalement", "ordinairement", "rituellement", "traditionnellement", "usuellement"), c("lemmes", "POS")] <- "ADVHAB"

# Adverbe modaux :

corpus[corpus$lemmes %in% c("apparemment", "assurément", "certainement", "effectivement", "éventuellement", "
                              évidemment", "fatalement", "forcément", "immanquablement", "incontestablement", "indéniablement", "
                              indiscutablement", "indubitablement", "inéluctablement", "inévitablement ", "infailliblement", "
                              manifestement", "naturellement", "nécessairement", "obligatoirement", "plausiblement", "possiblement", "
                              présumablement", "probablement", "supposément", "sûrement", "visiblement", "vraisemblablement", "vraiment", "
                              véritablement", "bien sûr", "certes", "sans doute", "sans aucun doute", "sans nul doute", "certes"), c("lemmes", "POS")] <- "ADVMOD"

## Retrait des lignes vides :
corpus <- corpus[complete.cases(corpus),]

corpus[corpus$lemmes %in% c("abjectement", "abruptement", "abstraitement", "abstrusément", "absurdement", "académiquement", "
                              acariâtrement", "accortement", "acerbement", "acidement", "âcrement", "acrimonieusement", "activement", "adipeusement", "
                              admirativement", "adroitement", "affablement", "affaireusement", "affectionnément", "affectueusement", "agilement", "
                              agressivement", "aguicheusement", "aigrement", "aimablement", "alertement", "allègrement", "allusivement", "altièrement", "
                              ambigument", "ambitieusement", "amènement", "amèrement", "amicalement", "amiteusement", "amoralement", "amoureusement", "
                              amusamment", "amusément", "angéliquement", "antipathiquement", "antisportivement", "anxieusement", "apathiquement", "
                              âprement", "archaïquement", "arrogamment", "artificieusement", "artistement", "ascétiquement", "assidûment", "astucieusement", "
                              attentivement", "audacieusement", "austèrement", "autonomement", "autoritairement", "avarement", "avaricieusement", "
                              aventureusement", "avidement", "badaudement", "badinement", "balourdement", "banalement", "barbarement", "baroquement", "
                              bassement", "batailleusement", "bavardement", "baveusement", "béatement", "bégueulement", "belliqueusement", "bénévolement", "
                              bénignement", "benoîtement", "béotiennement", "besogneusement", "bestialement", "bêtement", "bienheureusement", "bienveillament", "
                              bigotement", "bileusement", "bilieusement", "bizarement", "blagueusement", "blâmablement", "bonassement", "bordéliquement", "
                              boudeusement", "bouffonement", "bougonnement", "boulimiquement", "bourgeoisement", "bravachement", "bravement", "bredouillement", "
                              brièvement", "brillamment", "brouillonnement", "brumeusement", "brutalement", "bruyament", "burlesquement", "byzantinement", "
                              cabotinement", "cachottièrement", "cafardeusement", "cafouilleusement", "cajoleusement", "câlinement", "calmement", "calomnieusement", "
                              canaillement", "candidement", "capricieusement", "captieusement", "caractériellement", "cartésiennement", "casanièrement", "
                              caustiquement", "cauteleusement", "cavalièrement", "célibatairement", "cérémonieusement", "chafouinement", "chagrinement", "
                              chaleureusement", "chanceusement", "charismatiquement", "charitablement", "charitablement", "chastement", "chattement", "chaudement", "
                              chauvinement", "chevaleresquement", "chicanièrement", "chichiteusement", "chinoisement", "chipoteusement", "chiquement", "
                              chrétiennement", "circonspectement", "citadinement", "civilement", "clairement", "classiquement", "cocassement", "cochonnement", "
                              coércitivement", "coléreusement", "colériquement", "comiquement", "compendieusement", "complaisamment", "compréhensivement", "
                              concisément", "concussionnairement", "condamnablement", "confusément", "connement", "consciemment", "consciencieusement", "
                              conséquemment", "considérément", "contemplativement", "concrètement", "coquettement", "coquinement", "cordialement", "
                              coriacement", "corrosivement", "couardement", "coupablement", "courageusement", "courtoisement", "craintivement", "crânement", "
                              crapuleusement", "crédiblement", "crédulement", "crétinement", "criminellement", "critiquablement", "critiquement", "cruellement", "
                              crûment", "cuistrement", "cupidement", "curieusement", "cyniquement", "damnablement", "débilement", "débonnairement", "décemment", "
                              décidément", "dédaigneusement", "défavorablement", "dégoûtamment", "degueulassement", "délicatement", "déloyalement", "
                              démoniaquement", "dépendamment", "déplaisement", "déraisonnablement", "désapprobativement", "désespérément", "déshonnêtement", "
                              désinvoltement", "désobligeamment", "désordonnément", "despotiquement", "déterminément", "dévotement", "dévotieusement", "
                              dextrement", "dignement", "diligemment", "dinguement", "discourtoisement", "discrètement", "disertement", "disgracieusement", "
                              dissolument", "distraitement", "dithyrambiquement", "docilement", "doctement", "doctoralement", "doctrinairement", "dogmatiquement", "
                              dolemment", "dolentement", "domestiquement", "doucement", "doucereusement", "droitement", "drôlement", "dubitativement", "durement", "
                              dynamiquement", "économement", "efficacement", "effrénément", "effrontément", "égocentriquement", "égoïstement", "égrillardement", "
                              élégamment", "élitistement", "élogieusement", "éloquemment", "emphatiquement", "énergiquement", "enfantinement", "enigmatiquement", "
                              enjôleusement", "ennuyeusement", "ensorceleusement", "enthousiastement", "envieusement", "épicuriennement", "épileptiquement", "
                              équitablement", "équivoquement", "érotiquement", "éruditement", "ésotériquement", "espièglement", "estimablement", "étourdiment", "
                              étrangement", "euphoriquement", "évasivement", "exactement", "exaspérément", "excentriquement", "exclusivement", "exemplairement", "
                              expansivement", "expéditivement", "expertement", "explicitement", "facétieusement", "factieusement", "fadement", "fallacieusement", "
                              falotement", "faméliquement", "familièrement", "fanatiquement", "fanfaronnement", "fantaisistement", "fantasquement", "faraudement", "
                              fascistement", "fashionablement", "fastidieusement", "fastueusement", "fautivement", "favorablement", "fébrilement", "félinement", "
                              félonnement", "fémininement", "fermement", "férocement", "fervemment", "fiablement", "fidèlement", "fielleusement", "fièrement", "
                              fiévreusement", "finaudement", "finement", "flagorneusement", "flâneusement", "flatteusement", "flegmatiquement", "fofollement", "
                              folâtrement", "folkloriquement", "follement", "fougueusement", "fourbement", "franchement", "fraternellement", "frêlement", "
                              frénétiquement", "frigidement", "frileusement", "friponnement", "frivolement", "froidement", "froussardement", "frustement", "
                              fumeusement", "funestement", "furibondement", "furieusement", "futilement", "gaillardement", "gaîment", "galamment", "gallicanement", "
                              gaminement", "gâteusement", "gauchement", "gauloisement", "geignardement", "généreusement", "gentement", "gentiment", "glacialement", "
                              glorieusement", "gloutonnement", "godichement", "goguenardement", "gouilleusement", "goujatement", "goulûment", "gourdement", "
                              gourmandement", "gracieusement", "graveleusement", "gravement", "grincheusement", "grivoisement", "grossièrement", "grotesquement", "
                              guillerettement", "habilement", "hagardement", "haineusement", "haïssablement", "hardiment", "hargneusement", "hautainement", "
                              hérétiquement", "héroïquement", "hilarement", "honnêtement", "hospitalièrement", "hostilement", "humainement", "humblement", "
                              hyperboliquement", "hypocondriaquement", "hypocritement", "hystériquement", "idéalistement", "idiotement", "idolâtrement", "
                              ignarement", "ignoblement", "ignoramment", "imbécilement", "immodestement", "immondement", "immoralement", "immortellement", "
                              impardonnablement", "impartialement", "impassiblement", "impatiemment", "impavidement", "impénétrablement", "impérieusement", "
                              impersonnellement", "impertinemment", "imperturbablement", "impétueusement", "impitoyablement", "implacablement", "impoliment", "
                              impopulairement", "importunément", "imprudemment", "impudemment", "impudiquement", "impulsivement", "impurement", "inactivement", "
                              inamicalement", "inanomoviblement", "inattaquablement", "inattentivement", "inauthentiquement", "incapablement", "incestueusement", "
                              incisivement", "incivilement", "inciviquement", "incompétemment", "incongrûment", "inconsciemment", "inconséquemment", "inconsolablement", "
                              inconstamment", "incorrectement", "incrédulement", "increvablement", "indécemment", "indélicatement", "indépendamment", "indévotement", "
                              indigemment", "indiscrètement", "indocilement", "indolemment", "indulgemment", "industrieusement", "inélégamment", "inertement", "
                              inexcusablement", "inexpertement", "infâmement", "infatigablement", "infectement", "infidèlement", "inflexiblement", "ingénieusement", "
                              ingénument", "inglorieusement", "ingratement", "inhabilement", "inhospitalièrement", "inhumainement", "inintelligemment", "iniquement", "
                              injurieusement", "injustement", "inlassablement", "innocemment", "inoffensivement", "inquiètement", "insanement", "insensément", "insincèrement", "
                              insipidement", "insolemment", "insouciamment", "insoucieusement", "intègrement", "intelligemment", "interlopement", "intraitablement", "
                              intrépidement", "inventivement", "irasciblement", "ironiquement", "irraisonnablement", "irrationnellement", "irrépréhensiblement", "
                              irréprochablement", "irrésolument", "irrespectueusement", "irresponsablement", "irrévérencieusement", "jacobinement", "jalousement", "
                              janséniquement", "jésuitement", "jobardement", "jovialement", "joyeusement", "judicieusement", "justement", "lâchement", "laconiquement", "
                              ladrement", "langoureusement", "lascivement", "lassement", "légèrement", "lestement", "léthargiquement", "libéralement", "libertinement", "
                              libidineusement", "librement", "licencieusement", "lisiblement", "logiquement", "longanimement", "loquacement", "louangeusement", "
                              louchement", "loufoquement", "lourdaudement", "lourdement", "loyalement", "lubriquement", "lucidement", "lunatiquement", "luxurieusement", "
                              lymphatiquement", "lyriquement", "macabrement", "machiavéliquement", "magistralement", "magnanimement", "majestueusement", "
                              maladroitement", "malgracieusement", "malhabilement", "malheusement", "malhonnêtement", "malicieusement", "malignement", "
                              malproprement", "malveillament", "maniaquement", "marginalement", "marmiteusement", "martialement", "masculinement", "
                              masochistement", "matérialistement", "maternellement", "matoisement", "maupiteusement", "maussadement", "méchamment", "
                              méditativement", "mélancoliquement", "menteusement", "méphistophéliquement", "méprisablement", "mesquinement", "
                              mesurément", "méthodiquement", "méticuleusement", "mielleusement", "mièvrement", "mignardement", "mignonnement", "
                              minutieusement", "misérablement", "miséreusement", "miséricordieusement", "misogynement", "mochement", "modestement", "
                              mollassement", "mollement", "moqueusement", "moralement", "morosement", "morveusement", "muettement", "mutinement", "
                              naïvement", "narcissiquement", "narquoisement", "naturellement", "nébuleusement", "négligemment", "nerveusement", "
                              nettement", "niaisement", "nigaudement", "noblement", "nonchalamment", "nostalgiquement", "obèsement", "objectivement", "
                              obligeamment", "obséquieusement", "obtusément", "odieusement", "oisivement", "ombrageusement", "onctueusement", "
                              opiniâtrement", "opportunistement", "optimistement", "ordurièrement", "orgueilleusement", "originalement", "orthodoxement", "
                              oublieusement", "outrecuidament", "pacifiquement", "païennement", "paillardement", "paisiblement", "papelardement", "
                              paradoxalement", "paranoïaquement", "parcimonieusement", "paresseusement", "partialement", "passivement", "pataudement", "
                              patelinement", "paternellement", "pathétiquement", "patibulairement", "patiemment", "patriarcalement", "pauvrement", "
                              paysannement", "pédamment", "pédantement", "peinardement", "peineusement", "pénardement", "penaudement", "pendablement", "
                              pensivement", "pépèrement", "péremptoirement", "perfidement", "permissivement", "pernicieusement", "perplexement", "
                              persévéramment", "persifleusement", "perspicacement", "persuasivement", "perversement", "pesamment", "pessimistement", "
                              petitement", "peureusement", "philistinement", "phobiquement", "pieusement", "pinailleusement", "pingrement", "piteusement", "
                              pitoyablement", "placidement", "plaignardement", "plaintivement", "plaisamment", "platement", "plébéiennement", "
                              pleignardement", "pleutrement", "pointilleusement", "poliment", "polissonnement", "poltronnement", "pompeusement", "
                              ponctuellement", "pondérément", "populairement", "posément", "possessivement", "poussivement", "pragmatiquement", "
                              précautionneusement", "précieusement", "précisément", "présomptueusement", "prestement", "prétentieusement", "primairement", "
                              primesautièrement", "probement", "prodiguement", "profanement", "prolétairement", "prolixement", "proprement", "provincialement", "
                              prudement", "prudemment", "prudhommesquement", "pudibondement", "pudiquement", "puérilement", "pugnacement", "purement", "
                              puritainement", "pusillanimement", "quiètement", "racoleusement", "radinement", "rageusement", "raidement", "railleusement", "
                              raisonnablement", "rapacement", "réactionnairement", "réalistement", "rébarbativement", "répressivement", "résolument", "
                              respectablement", "respectueusement", "revêchement", "révérement", "révérencieusement", "rêveusement", "ridiculement", "
                              rieusement", "rigoureusement", "ringardement", "robustement", "roidement", "romainement", "romanesquement", "roturièrement", "
                              roublardement", "rudement", "rustaudement", "rustrement", "sacrilègement", "sadiquement", "sagacement", "sagement", "saintement", "
                              salacement", "salaudement", "salement", "sanguinairement", "sarcastiquement", "sataniquement", "sauvagement", "savamment", "
                              scabreusement", "scélératement", "sceptiquement", "schématiquement", "scolairement", "scrupuleusement", "sèchement", "
                              sectairement", "sédentairement", "séditieusement", "sénilement", "sensément", "sensuellement", "sentencieusement", "
                              sentimentalement", "sereinement", "sérieusement", "serviablement", "servilement", "sévèrement", "sibyllinement", "
                              silencieusement", "simplement", "sincèrement", "singulièrement", "sinistrement", "siouxement", "sobrement", "sociablement", "
                              soigneusement", "solitairement", "sombrement", "songeusement", "sottement", "soucieusement", "soupçonneusement", "souplement", "
                              sourcilleusement", "sournoisement", "souverainement", "spartiatement", "spirituellement", "spontanément", "sportivement", "
                              staliniennement", "stoïquement", "strictement", "studieusement", "stupidement", "subtilement", "subversivement", "
                              succinctement", "suicidairement", "superficiellement", "superfinement", "supersitieusement", "sûrement", "suspicieusement", "
                              sympatiquement", "taciturnement", "talentueusement", "taquinement", "tatillonnement", "teigneusement", "témérairement", "
                              tenacement", "tendrement", "ténébreusement", "tièdement", "timidement", "tortueusement", "tracassièrement", "tranquillement", "
                              tristement", "trivialement", "trouillardement", "turpidement", "tyranniquement", "urbainement", "vaillammment", "valeureusement", "
                              vaniteusement", "vantardement", "vaseusement", "véhémentement", "velléitairement", "venimeusement", "verbeusement", "
                              versatilement", "vertueusement", "vétilleusement", "veulement", "vicieusement", "victorieusement", "vieillottement", "
                              vigilamment", "vigoureusement", "vilainement", "vilement", "vindicativement", "violemment", "virilement", "virulemment", "
                              vivement", "volagement", "volubilement", "voluptueusement", "voracement", "vulgairement", "abjectement", "adroitement", "
                              audacieusement", "charitablement", "connement", "courageusement", "cruellement", "égoïstement", "généreusement", "
                              habilement", "héroïquement", "imbécilement", "imprudemment", "inintelligemment", "intelligemment", "lâchement", "
                              magnanimement", "prudemment", "sadiquement", "sagement", "témérairement", "astucieusement", "bassement", "bêtement", "
                              criminellement", "idiotement", "judicieusement", "perversement", "sottement", "stupidement", "bizarrement", "
                              curieusement", "étonnamment", "étrangement", "fâcheusement", "inexplicablement", "paradoxalement", "regrettablement"), c("lemmes", "POS")] <- "ADVMAN"

## Retrait des lignes vides :
corpus <- corpus[complete.cases(corpus),]

## Cas où l'on part des POS pour changer les lemmes :
## Ici, transformation des adverbes restants en ADV
corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, POS == "ADV", "ADV"))

## Noms communs :

corpus[corpus$lemmes %in% c("bien-être", "accablement", "acuité", "admiration", "affection", "joie", "alacrité", "allégresse", "
                              amitié", "amour", "tristesse", "angoisse", "animosité", "anxiété", "apaisement", "appréhension", "attendrissement", "
                              attirance", "attraction", "douleur", "peur", "aversion", "plaisir", "bonheur", "sensation", "calme", "désenchantement", "
                              plaisir", "réconfort", "ennui", "orgueil", "bonheur", "écoeurement", "soulagement", "malaise", "trouble", "sentiment", "
                              horreur", "inquiétude", "émotion", "gêne", "hostilité", "paresse", "fierté", "honte", "sympathie", "satisfaction", "
                              tendresse", "retenue", "hostilité", "joie", "jouissance", "chagrin", "consolation", "consternation", "contentement", "
                              contrariété", "crainte", "déception", "regret", "curiosité", "douleur", "doute", "dégoût", "déchirement", "délectation", "
                              délivrance", "dépit", "déplaisir", "désarroi", "désespoir", "désir", "détachement", "détresse", "embarras", "engourdissement", "
                              ennui", "exaltation", "exaspération", "excitation", "fatigue", "frisson", "frémissement", "félicité", "goût", "plaisir", "trouble", "
                              soulagement", "saisissement", "estime", "réconfort", "soulagement", "honte", "peine", "frayeur", "humiliation", "déception", "
                              répugnance", "paresse", "impatience", "pitié", "insouciance", "peine", "satisfaction", "lassitude", "stupeur", "amertume", "
                              solidarité", "souffrance", "indignation", "gratitude", "humiliation", "inquiétude", "irritation", "ivresse", "mélancolie", "
                              mépris", "nostalgie", "désappointement", "passion", "perplexité", "sensation", "ravissement", "reconnaissance", "remord", "
                              respect", "répugnance", "répulsion", "pressentiment", "sentiment", "humiliation", "tentation", "chagrin", "beauté", "charme", "
                              coquetterie", "courage", "courtoisie", "douceur", "ennui", "gaîté", "gentillesse", "laideur", "piété", "imprudence", "prudence", "
                              sagesse", "sensibilité", "insincérité", "sincérité", "sérénité", "timidité", "tristesse", "violence", "abnégation", "ambition", "
                              amoralité", "angélisme", "ardeur", "combativité", "audace", "autoritarisme", "aptitude", "entrain", "ingéniosité", "finesse", "
                              doigté", "tact", "patience", "courage", "volonté", "complaisance", "compréhension", "incompétence", "compétence", "connerie", "
                              bêtise", "curiosité", "célérité", "discernement", "discrétion", "défaitisme", "dévouement", "esprit", "faiblesse", "fantaisie", "
                              fermeté", "finesse", "grossièreté", "générosité", "humanité", "humilité", "ignorance", "imagination", "impartialité", "impatience", "
                              imprudence", "imprévoyance", "incapacité", "inconscience", "indifférence", "indiscipline", "indulgence", "indépendance", "
                              initiative", "insensibilité", "intelligence", "intrépidité", "irrespect", "jovialité", "modestie", "obstination", "optimisme", "
                              originalité", "outrecuidance", "partialité", "impatience", "patience", "patriotisme", "persuasion", "pessimisme", "objectivité", "
                              nonchalance", "modération", "impudeur", "pudeur", "puérilité", "rapidité", "rigueur", "incompétence", "souplesse", "stoïcisme", "
                              prévoyance", "cynisme", "tolérance", "arrogance", "talent", "zèle", "charisme", "sang-froid", "aisance", "bonté", "bravoure", "dilection", "
                              discrétion", "délicatesse", "efficacité", "endurance", "exagération", "élégance", "intelligence", "intrépidité", "intuition", "
                              lucidité", "lâcheté", "mansuétude", "naïveté", "paresse", "impolitesse", "politesse", "résignation", "résistance", "fantaisie", "
                              abnégation", "ambition", "amoralité", "sentiment", "combativité", "audace", "autoritarisme", "autorité", "dévouement", "hospitalité", "
                              impatience", "imprudence", "imprévoyance", "inconscience", "indulgence", "insensibilité", "intrépidité", "intégrité", "irrespect", "
                              mansuétude", "obstination", "optimisme", "outrecuidance", "impartialité", "partialité", "puérilité", "pessimisme", "qualité", "
                              incompétence", "stoïcisme", "dynamisme", "négligence", "avarice", "intrépidité"), c("lemmes", "POS")] <- "NCABS"

corpus[corpus$lemmes %in% c("visage", "figure", "cheveu", "front", "sourcil", "yeux", "cil", "nez", "oeil", "bouche", "lèvre", 
                            "menton", "joue", "oreille", "gorge", "poil", "bras", "main", "doigt", "jambe", "cuisse", "tête", "cou", "épaule", "coude", 
                            "avant-bras", "poignet", "hanche", "genou", "cheville", "front", "orteil", "thorax", "abdomen", "barbe", "moustache", "duvet", 
                            "langue", "dent", "tempe", "fesse", "pied"), c("lemmes", "POS")] <- "NCCOR"


## Simplification des POS avec regex : 
## NB : non prise en compte des regex dans les fonctions qui suivent...
## Donc obliger de simplifier avant.
# corpus <- corpus %>%
#   mutate(POS = str_replace_all(.$POS, "NC.+", "NC")) %>%
#   mutate(POS = str_replace_all(.$POS, "VPARPM.+", "VPARPM")) %>%
#   mutate(POS = str_replace_all(.$POS, "VPARPF.+", "VPARPF")) %>%
#   mutate(POS = str_replace_all(.$POS, "VINDPS.+", "VINDPS")) %>%
#   mutate(POS = str_replace_all(.$POS, "VINDP3S", "VINDPS")) %>%
#   mutate(POS = str_replace_all(.$POS, "VSUBP.+", "VSUBP")) %>%
#   mutate(POS = str_replace_all(.$POS, "VSUBI.+", "VSUBI")) %>%
#   mutate(POS = str_replace_all(.$POS, "VCOND.+", "VCOND")) %>%
#   mutate(POS = str_replace_all(.$POS, "VCONP.+", "VCONP")) %>%
#   mutate(POS = str_replace_all(.$POS, "VINDI.+", "VINDI")) %>%
#   mutate(POS = str_replace_all(.$POS, "NH.+", "NH")) %>%
#   mutate(POS = str_replace_all(.$POS, "NH.+", "NH")) %>%
#   mutate(POS = str_replace_all(.$POS, "NH.+", "NH")) %>%
#   mutate(POS = str_replace_all(.$POS, "NH.+", "NH")) %>%
#   mutate(POS = str_replace_all(.$POS, "NP.+", "NP"))

# TODO : les regex qui précèdent ne servent à rien dans l'étiquetage UDPIPE, non? 

## Cas où l'on part des POS pour changer les lemmes :
corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, POS == "ADJ", "ADJ")) %>%
  mutate(lemmes = replace(lemmes, POS == "NUM", "ADJ")) %>%  
  mutate(lemmes = replace(lemmes, POS == "DETPOSS", "DETPOSS")) %>%
  mutate(lemmes = replace(lemmes, lemmes == "elle", "il")) %>%
  mutate(lemmes = replace(lemmes, POS == "NOUN", "NC")) %>%
  mutate(lemmes = replace(lemmes, POS == "PROPN", "NP")) %>%
  mutate(lemmes = replace(lemmes, POS == "INTJ", "INTJ")) %>%
  mutate(lemmes = replace(lemmes, lemmes == "«", "AEFFACER")) %>% # TODO : vérifier si c'est pertinent de garder cela ??
  mutate(lemmes = replace(lemmes, lemmes == "»", "AEFFACER"))

# Manque :  

#^\bque\b\tPRI > que_PR
#^\bque\b\tSUB > que_SUB
#^\bque\b\tADV > que_ADV

# Retrait des AEFFACER :
corpus <- corpus %>%
  mutate(lemmes = replace(lemmes, lemmes == "AEFFACER", "")) %>%
  mutate(lemmes = replace(lemmes, POS == "AEFFACER", ""))


## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 

## FIN DU SCRIPT PERL expressions2.perl ##

## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 

## Retrait des lignes vides :
corpus <- as_tibble(corpus)
corpus <- corpus[complete.cases(corpus),]

# Vérification :

which(corpus$lemmes == "AEFFACER")
which(corpus$POS == "AEFFACER")
which(corpus$lemmes == "")
which(corpus$POS == "")

t <- which(corpus$mots == "aux")
e <- which(corpus$mots == "du")
f <- which(corpus$mots == "des")
g <- which(corpus$mots == "au")
d <- which(corpus$lemmes == "")
# expl <- which(corpus$POS == "PART") # Suppression explétifs.

if(length(d) > 0) {
  corpus = corpus[-d,1:4] 
}

retrait_na <- which(corpus$mots == "NA")

if(length(retrait_na) > 0){
  corpus <- corpus[-retrait_na,1:4]
}

if(length(t) > 0){
  corpus <- corpus %>%
    mutate(lemmes = replace(lemmes, mots == "aux", "à_le"))
}

if(length(e) > 0){
  corpus <- corpus %>%
    mutate(lemmes = replace(lemmes, mots == "du", "de_le"))
}

if(length(f) > 0){
  corpus <- corpus %>%
    mutate(lemmes = replace(lemmes, mots == "des", "de_le"))
}

if(length(g) > 0){
  corpus <- corpus %>%
    mutate(lemmes = replace(lemmes, mots == "au", "à_le"))
}

## Exportation de la première et 3ème colonne csv :

corpus <- corpus[-3] # Suppression colonne POS

## Renommer la colonne motifs :

names(corpus) <- c("mots", "motifs", "Oeuvre")

## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 

# Choix du nombre de ngrams : 

corpus_spec <- corpus

corpus_spec_punct <- corpus_spec  %>%
  mutate(
    next_motif = lead(motifs),
    next_motif2 = lead(motifs, 2),
    next_motif3 = lead(motifs, 3),
    next_motif4 = lead(motifs, 4),
    next_motif5 = lead(motifs, 5)
  ) %>%
  filter(
    !is.na(next_motif),!is.na(next_motif2),!is.na(next_motif3),!is.na(next_motif4),!is.na(next_motif5)
  ) %>%
  mutate(ngrammotif = paste(
    motifs,
    next_motif,
    next_motif2,
    next_motif3,
    next_motif4,
    next_motif5
  ))

# Sixgrams mots :

corpus_spec_punct <- corpus_spec_punct  %>%
  mutate(
    next_word = lead(mots),
    next_word2 = lead(mots, 2),
    next_word3 = lead(mots, 3),
    next_word4 = lead(mots, 4),
    next_word5 = lead(mots, 5)
  ) %>%
  filter(
    !is.na(next_word),!is.na(next_word2),!is.na(next_word3),!is.na(next_word4),!is.na(next_word5)
  ) %>%
  mutate(ngrammot = paste(
    mots,
    next_word,
    next_word2,
    next_word3,
    next_word4,
    next_word5
  ))

# Sélection et renommage des colonnes :

corpus_spec_punct <-
  corpus_spec_punct[, c("mots", "ngrammot", "ngrammotif", "Oeuvre")]

names(corpus_spec_punct) <- c("mots", "ngrammot", "motifs", "Oeuvre")

## Dénombrement :

count_motifs_spec <- corpus_spec_punct %>%
  count(motifs, sort = TRUE)

## Retour aux textes sur un motif particulier : 
## on se fonde ici simplement sur le tableau corpus_spec_punct :

a <- which(corpus_spec_punct$motifs == "de le NC de le NC")

df_motif <- corpus_spec_punct[a,]

## TODO: Sélection de patterns stylistiques marrants ?


## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 
## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 
## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 
## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## 

# Clustering /// années ? 
# Clustering /// thèmes ?
# Tf-IDF sur les mots les plus discriminants : nécessite d'organiser le corpus
# 30 ans / 30 ans.












